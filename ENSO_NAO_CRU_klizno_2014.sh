 GODINE[1]=1998                            #ENSO ++,   NAO 0
GODINEm[1]=1997                            #ENSO ++,   NAO 0
 GODINE[2]=1988                            #ENSO + ,   NAO 0
GODINEm[2]=1987                            #ENSO + ,   NAO 0
 GODINE[3]=${GODINE[1]},${GODINE[2]}       #ENSO ++/+, NAO 0
GODINEm[3]=${GODINEm[1]},${GODINEm[2]}     #ENSO ++/+, NAO 0
     GODINE[4]=1967,1968,1984,1986         #ENSO - ,   NAO 0
    GODINEm[4]=1966,1967,1983,1985         #ENSO - ,   NAO 0
     GODINE[5]=1971,1974,1999              #ENSO --,   NAO 0
    GODINEm[5]=1970,1973,1998              #ENSO --,   NAO 0
     GODINE[6]=${GODINE[4]},${GODINE[5]}   #ENSO --/-, NAO 0
    GODINEm[6]=${GODINEm[4]},${GODINEm[5]} #ENSO --/-, NAO 0

 GODINE[7]=1973,1983,1992,1998,1987,1966                     #ENSO ++,   NAO all
GODINEm[7]=1972,1982,1991,1997,1986,1965                     #ENSO ++,   NAO all
 GODINE[8]=1995,1988,1977,1969                               #ENSO + ,   NAO all
GODINEm[8]=1994,1987,1976,1968                               #ENSO + ,   NAO all
 GODINE[9]=${GODINE[7]},${GODINE[8]}                         #ENSO ++/+, NAO all
GODINEm[9]=${GODINEm[7]},${GODINEm[8]}                       #ENSO ++/+, NAO all
     GODINE[10]=1967,1968,1984,1986,1985,1996                #ENSO - ,   NAO all
    GODINEm[10]=1966,1967,1983,1985,1984,1995                #ENSO - ,   NAO all
     GODINE[11]=1989,1976,2000,1971,1974,1999                #ENSO --,   NAO all
    GODINEm[11]=1988,1975,1999,1970,1973,1998                #ENSO --,   NAO all
     GODINE[12]=${GODINE[10]},${GODINE[11]}   		     #ENSO --/-, NAO all
    GODINEm[12]=${GODINEm[10]},${GODINEm[11]}                #ENSO --/-, NAO all

 GODINE[13]=1990,1993                         #ENSO 0,   NAO ++
GODINEm[13]=1989,1992                         #ENSO 0,   NAO ++
 GODINE[14]=1994,1997                         #ENSO 0,   NAO +
GODINEm[14]=1993,1996                         #ENSO 0,   NAO +
 GODINE[15]=${GODINE[13]},${GODINE[14]}       #ENSO 0,   NAO ++/+
GODINEm[15]=${GODINEm[13]},${GODINEm[14]}     #ENSO 0,   NAO ++/+
     GODINE[16]=1964,1965,1970,1979,1980      #ENSO 0,   NAO -
    GODINEm[16]=1963,1964,1969,1978,1979      #ENSO 0,   NAO -
     GODINE[17]=1963                          #ENSO 0,   NAO --
    GODINEm[17]=1962                          #ENSO 0,   NAO --
     GODINE[18]=${GODINE[16]},${GODINE[17]}   #ENSO 0,   NAO --/-
    GODINEm[18]=${GODINEm[16]},${GODINEm[17]} #ENSO 0,   NAO --/-

 GODINE[19]=1989,1990,1993,1995                              #ENSO all,   NAO ++
GODINEm[19]=1988,1989,1992,1994                              #ENSO all,   NAO ++
 GODINE[20]=1976,2000,1994,1997,1973,1983,1992               #ENSO all,   NAO +
GODINEm[20]=1975,1999,1993,1996,1972,1982,1991               #ENSO all,   NAO +
 GODINE[21]=${GODINE[19]},${GODINE[20]}                      #ENSO all,   NAO ++/+
GODINEm[21]=${GODINEm[19]},${GODINEm[20]}                    #ENSO all,   NAO ++/+
     GODINE[22]=1985,1996,1964,1965,1970,1979,1980,1977,1987 #ENSO all,   NAO -
    GODINEm[22]=1984,1995,1963,1964,1969,1978,1979,1976,1986 #ENSO all,   NAO -
     GODINE[23]=1963,1969,1966                               #ENSO all,   NAO --
    GODINEm[23]=1962,1968,1965                               #ENSO all,   NAO --
     GODINE[24]=${GODINE[22]},${GODINE[23]}                  #ENSO all,   NAO --/-
    GODINEm[24]=${GODINEm[22]},${GODINEm[23]}                #ENSO all,   NAO --/-



 GODINE[25]=1973,1983,1992,1987,1966                     #ENSO ++,   NAO nonzero (no 1998)
GODINEm[25]=1972,1982,1991,1986,1965                     #ENSO ++,   NAO nonzero (no 1997)
 GODINE[26]=1995,1977,1969                               #ENSO + ,   NAO nonzero (no 1988)
GODINEm[26]=1994,1976,1968                               #ENSO + ,   NAO nonzero (no 1987)
 GODINE[27]=${GODINE[25]},${GODINE[26]}                  #ENSO ++/+, NAO nonzero 
GODINEm[27]=${GODINEm[25]},${GODINEm[26]}                #ENSO ++/+, NAO nonzero
     GODINE[28]=1985,1996                                #ENSO - ,   NAO nonzero (no 1967, 1968, 1984, 1986)
    GODINEm[28]=1984,1995                                #ENSO - ,   NAO nonzero (no 1966, 1967, 1983, 1985)
     GODINE[29]=1989,1976,2000                           #ENSO --,   NAO nonzero (no 1971, 1974, 1999)
    GODINEm[29]=1988,1975,1999                           #ENSO --,   NAO nonzero (no 1970, 1973, 1998)
     GODINE[30]=${GODINE[28]},${GODINE[29]}   		 #ENSO --/-, NAO nonzero
    GODINEm[30]=${GODINEm[28]},${GODINEm[29]}            #ENSO --/-, NAO nonzero

 GODINE[31]=1989,1995                                    #ENSO nonzero (no 1990,1993) ,   NAO ++
GODINEm[31]=1988,1994                                    #ENSO nonzero (no 1989,1992) ,   NAO ++
 GODINE[32]=1976,2000,1973,1983,1992                     #ENSO nonzero (no 1994,1997) ,   NAO +
GODINEm[32]=1975,1999,1972,1982,1991                     #ENSO nonzero (no 1993,1996) ,   NAO +
 GODINE[33]=${GODINE[31]},${GODINE[32]}                  #ENSO nonzero,   NAO ++/+
GODINEm[33]=${GODINEm[31]},${GODINEm[32]}                #ENSO nonzero,   NAO ++/+
     GODINE[34]=1985,1996,1977,1987                      #ENSO nonzero ( no 1964, 1965, 1970, 1979, 1980),   NAO -
    GODINEm[34]=1984,1995,1976,1986                      #ENSO nonzero ( no 1963, 1964, 1969, 1978, 1979),   NAO -
     GODINE[35]=1969,1966                                #ENSO nonzero ( no 1963),   NAO --
    GODINEm[35]=1968,1965                                #ENSO nonzero ( no 1962),   NAO --
     GODINE[36]=${GODINE[34]},${GODINE[35]}              #ENSO nonzero,   NAO --/-
    GODINEm[36]=${GODINEm[34]},${GODINEm[35]}            #ENSO nonzero,   NAO --/-


for VAR in pr ; do

#       FILE[1]="/home/ivan/OBS/CRU/cru_ts_3_10_01.1901.2009.pre.dat_nc3.nc"
        FILE[1]="/home/ivan/OBS/CRU/cru_ts_3_10_01.1901.2009.pre.dat_nc4.nc"

        SEAStxt[ 1]="FMA"
        SEAStxt[ 2]="MAM"
        SEAStxt[ 3]="AMJ"
        SEAStxt[ 4]="MJJ"
        SEAStxt[ 5]="JJA"
        SEAStxt[ 6]="JAS"
        SEAStxt[ 7]="ASO"
        SEAStxt[ 8]="SON"
        SEAStxt[ 9]="OND"
        SEAStxt[10]="NDJ"
        SEAStxt[11]="DJF"
        SEAStxt[12]="JFM"

        SETmontxt[ 1]=03
        SETmontxt[ 2]=04
        SETmontxt[ 3]=05
        SETmontxt[ 4]=06
        SETmontxt[ 5]=07
        SETmontxt[ 6]=08
        SETmontxt[ 7]=09
        SETmontxt[ 8]=10
        SETmontxt[ 9]=11
        SETmontxt[10]=12
        SETmontxt[11]=01
        SETmontxt[12]=02

#-----------------
#----------------- STEP 1: izracunati sezonski srednjak za svaku godinu i svaki model odvojeno
#-----------------
echo '=================================================================================================='
echo '                                      STEP 1'
echo '=================================================================================================='
    for MOD in 1           ; do

        INPUT=${FILE[${MOD}]}
        OUTPUT=running.nc
        cdo -r -f nc -b 32 divdpm  -setday,15 -runmean,3 -seldate,1961-01-01,2000-12-31 ${INPUT} ${OUTPUT}

        for SES in {1..12} ; do

            INPUT=running.nc
            OUTPUT=${VAR}_CRU_SM_${SEAStxt[${SES}]}_SMS_2014.nc   #Ovdje su sve mjesecne vrijednosti za pojedinu sezonu u periodu 1961-2000
            cdo -r -selmon,${SETmontxt[${SES}]}  ${INPUT} ${OUTPUT}

        done #SES

        rm running.nc
    done #MOD



#-----------------
#----------------- STEP 2: izracunati za svaku godinu odvojeno i sve modele skupa taj srednjak. Nakon toga, srednjak po svim godinama i svim modelima
#-----------------
echo '=================================================================================================='
echo '                                      STEP 2'
echo '=================================================================================================='

for TIP in {1..36}                     ; do
    for SES in 1 2 3 4 5 6 7 8 9 11 12 ; do
        INPUT=${VAR}_CRU_SM_${SEAStxt[${SES}]}_SMS_2014.nc
        OUTPUT1=${VAR}_CRU_TIMAVG_SM_${SEAStxt[${SES}]}_SMS_2014.nc              #Ovdje je visegodisnji srednjak po SVIM     godinama
        OUTPUT2=${VAR}_CRU_TIMAVG_TIP${TIP}_SM_${SEAStxt[${SES}]}_SMS_2014.nc    #Ovdje je visegodisnji srednjak po ODBRANIM godinama

        cdo timavg                               ${INPUT} ${OUTPUT1}
        cdo timavg -selyear,${GODINE[${TIP}]}    ${INPUT} ${OUTPUT2}
    done #od SES

    for SES in 10 ; do
        INPUT=${VAR}_CRU_SM_${SEAStxt[${SES}]}_SMS_2014.nc
        OUTPUT1=${VAR}_CRU_TIMAVG_SM_${SEAStxt[${SES}]}_SMS_2014.nc              #Ovdje je visegodisnji srednjak po SVIM      godinama
        OUTPUT2=${VAR}_CRU_TIMAVG_TIP${TIP}_SM_${SEAStxt[${SES}]}_SMS_2014.nc    #Ovdje je visegodisnji srednjka po ODABRANIM godinama

        cdo timavg                               ${INPUT} ${OUTPUT1}
        cdo timavg -selyear,${GODINEm[${TIP}]}   ${INPUT} ${OUTPUT2}
    done #od SES
done #od TIP



#-----------------
#----------------- STEP 3: kompozit analiza za pojedini tip godina
#-----------------
echo '=================================================================================================='
echo '                                      STEP 3'
echo '=================================================================================================='

for TIP in {1..36}                         ; do
    for SES in 1 2 3 4 5 6 7 8 9 10 11 12  ; do

	INPUT1=${VAR}_CRU_TIMAVG_TIP${TIP}_SM_${SEAStxt[${SES}]}_SMS_2014.nc
	INPUT2=${VAR}_CRU_TIMAVG_SM_${SEAStxt[${SES}]}_SMS_2014.nc
	OUTPUT=${VAR}_CRU_SM_${SEAStxt[${SES}]}_TIP${TIP}_anomaly_SMS_2014.nc  #Ovdje je razlika visegodisnjih srednjaka po SVIM i ODABRANIM godinama
		cdo sub ${INPUT1} ${INPUT2} ${OUTPUT}

    done #od SES
done #od TIP

done #od VAR
